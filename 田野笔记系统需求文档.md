# 田野笔记与访谈记录系统需求文档

## 1. 项目概述

### 1.1 项目背景
本系统旨在为人类学、社会学等领域的研究者提供专业的田野笔记与访谈记录管理平台，支持研究数据的系统化存储、检索和分析。

### 1.2 项目目标
- 提供便捷的田野笔记创建与管理功能
- 支持多维度的数据检索与过滤
- 实现研究数据的安全存储与权限管理
- 提供基础的统计分析功能
- 支持研究协作与数据共享

### 1.3 技术架构
- **后端**: FastAPI (Python)
- **数据库**: MySQL 8.0+ (利用JSON字段存储笔记内容)
- **前端**: React + Material UI (MUI)
- **文件存储**: 本地文件系统 (相对路径)

## 2. 功能需求

### 2.1 用户管理

#### 2.1.1 用户角色
- **管理员 (Admin)**
  - 创建和管理研究者账号
  - 管理系统基础数据 (参与者、场域信息)
  - 查看所有田野记录
  - 系统配置与维护

- **研究者 (Researcher)**
  - 创建、编辑、删除自己的田野记录
  - 查看所有研究者的记录 (只读)
  - 管理个人的参与者和场域信息
  - 导出和统计分析功能

#### 2.1.2 用户认证
- 用户名/密码登录
- 会话管理与自动登出
- 密码重置功能

### 2.2 参与者管理

#### 2.2.1 参与者信息结构
```json
{
  "participant_id": "唯一标识",
  "basic_info": {
    "name_or_code": "姓名或代号",
    "gender": "性别",
    "age_range": "年龄段",
    "occupation": "职业/身份",
    "education": "教育背景"
  },
  "contact_info": {
    "phone": "电话 (可选)",
    "email": "邮箱 (可选)"
  },
  "social_attributes": {
    "social_status": "社会地位",
    "family_status": "家庭状况",
    "economic_status": "经济状况"
  },
  "research_related": {
    "participation_time": "参与研究时间",
    "participation_method": "参与方式",
    "relationship_network": "与其他参与者关系"
  },
  "privacy_settings": {
    "is_anonymous": "是否匿名化",
    "data_sensitivity": "数据敏感级别"
  },
  "notes": "备注信息",
  "created_by": "创建者ID",
  "created_at": "创建时间",
  "updated_at": "更新时间"
}
```

#### 2.2.2 参与者管理功能
- 添加、编辑、删除参与者信息
- 参与者信息搜索与过滤
- 匿名化处理
- 参与者关系网络可视化

### 2.3 场域信息管理

#### 2.3.1 场域层级结构
```
区域 (Region) 
├── 具体地点 (Location)
│   ├── 子场域 (Sub-field)
```

#### 2.3.2 场域信息结构
```json
{
  "field_id": "唯一标识",
  "hierarchy": {
    "region": "区域 (省/市/区县)",
    "location": "具体地点 (社区/机构/建筑物)",
    "sub_field": "子场域 (房间/区域/活动空间)"
  },
  "geographic_info": {
    "latitude": "纬度 (可选)",
    "longitude": "经度 (可选)",
    "address": "详细地址"
  },
  "description": {
    "environment": "环境特征",
    "cultural_background": "文化背景",
    "accessibility": "访问便利性"
  },
  "time_attributes": {
    "active_hours": "活跃时间段",
    "seasonal_changes": "季节性变化"
  },
  "created_by": "创建者ID",
  "created_at": "创建时间",
  "updated_at": "更新时间"
}
```

### 2.4 标签系统

#### 2.4.1 标签分类体系
- **主题分类 (Theme)**
  - 研究主题: 教育、医疗、社区治理、文化传承等
  - 方法论: 参与观察、深度访谈、焦点小组等
  - 情感色彩: 积极、消极、中性、复杂等
  - 数据类型: 定性、定量、混合等
  - 研究阶段: 前期探索、深入调研、验证阶段等

- **内容分类 (Content)**
  - 行为观察: 日常行为、仪式行为、冲突行为等
  - 话语分析: 正式表达、非正式交流、沉默等
  - 物质文化: 空间布局、物品使用、符号意义等
  - 社会关系: 权力关系、亲属关系、经济关系等

- **分析维度 (Analysis)**
  - 理论框架: 结构功能、符号互动、批判理论等
  - 重要程度: 核心发现、支撑材料、背景信息等
  - 可信度: 直接观察、二手资料、传闻等
  - 后续行动: 需要验证、需要深入、已经饱和等

#### 2.4.2 标签管理功能
- 用户自由创建标签
- 标签分类管理
- 标签使用频率统计
- 标签合并与删除

### 2.5 田野记录管理

#### 2.5.1 记录信息结构
```json
{
  "record_id": "唯一标识",
  "basic_info": {
    "title": "记录标题",
    "type": "记录类型 (田野笔记/访谈记录/观察记录)",
    "date": "记录日期",
    "time_range": "时间段",
    "duration": "持续时间"
  },
  "participants": ["参与者ID列表"],
  "field_info": {
    "field_id": "场域ID",
    "specific_location": "具体位置描述"
  },
  "content": {
    "main_content": "主要内容 (富文本)",
    "key_quotes": "重要引用",
    "observations": "观察要点",
    "reflections": "研究者反思"
  },
  "tags": {
    "theme_tags": ["主题标签"],
    "content_tags": ["内容标签"],
    "analysis_tags": ["分析标签"]
  },
  "attachments": {
    "images": [
      {
        "filename": "文件名",
        "path": "相对路径",
        "thumbnail": "缩略图路径",
        "description": "图片描述",
        "upload_time": "上传时间"
      }
    ]
  },
  "metadata": {
    "created_by": "创建者ID",
    "created_at": "创建时间",
    "updated_at": "更新时间",
    "version": "版本号",
    "status": "状态 (草稿/已完成/已归档)"
  }
}
```

#### 2.5.2 记录管理功能
- 创建、编辑、删除田野记录
- 富文本编辑器支持
- 图片上传与管理
- 记录版本控制
- 记录状态管理

### 2.6 检索与过滤

#### 2.6.1 检索维度
- **时间维度**: 日期范围、时间段
- **人物维度**: 参与者筛选
- **地点维度**: 场域层级筛选
- **标签维度**: 多标签组合筛选
- **内容维度**: 全文搜索

#### 2.6.2 高级检索功能
- 多条件组合查询
- 保存常用查询条件
- 查询结果排序 (时间、相关度、重要性)
- 查询结果导出

### 2.7 统计分析

#### 2.7.1 基础统计
- 不同地点的记录数量分布
- 不同参与者的记录数量分布
- 不同主题标签的记录数量分布
- 时间维度的记录分布趋势

#### 2.7.2 可视化图表
- 柱状图: 数量分布
- 饼图: 比例分析
- 时间线: 记录时间分布
- 网络图: 参与者关系网络

### 2.8 数据导出

#### 2.8.1 导出格式
- PDF: 格式化报告
- Word: 可编辑文档
- Excel: 结构化数据
- JSON: 原始数据

#### 2.8.2 导出选项
- 选择性导出 (指定记录)
- 批量导出 (按条件筛选)
- 数据脱敏处理
- 附件打包下载

## 3. 非功能需求

### 3.1 性能要求
- 系统响应时间 < 2秒
- 支持并发用户数: 50+
- 数据库查询优化
- 图片加载优化

### 3.2 安全要求
- 用户身份认证
- 数据传输加密 (HTTPS)
- 敏感数据加密存储
- 操作日志记录

### 3.3 可用性要求
- 系统可用性 > 99%
- 数据备份策略
- 错误恢复机制
- 用户友好的界面设计

### 3.4 兼容性要求
- 支持主流浏览器 (Chrome, Firefox, Safari, Edge)
- 响应式设计 (桌面端优先)
- 移动端基础适配

## 4. 数据权限设计

### 4.1 权限矩阵
```
操作类型    │ 自己的记录 │ 他人的记录 │ 管理员权限
─────────────────────────────────────────
创建        │ ✅        │ ❌        │ ✅
查看        │ ✅        │ ✅        │ ✅  
编辑        │ ✅        │ ❌        │ ✅
删除        │ ✅        │ ❌        │ ✅
导出        │ ✅        │ ✅*       │ ✅
统计分析    │ ✅        │ ✅        │ ✅
```
*研究者导出他人记录时自动脱敏处理

### 4.2 数据隔离
- 研究者只能编辑自己创建的记录
- 研究者可以查看但不能修改他人的记录
- 管理员拥有所有数据的完整权限
- 敏感数据的访问控制

## 5. 技术实现要点

### 5.1 数据库设计
- 利用MySQL 8.0的JSON字段存储灵活的笔记内容
- 建立适当的索引优化查询性能
- 设计合理的表结构支持复杂查询

### 5.2 文件管理
- 图片文件相对路径存储: `/uploads/{user_id}/{year}/{month}/{record_id}/`
- 支持格式: JPG, PNG, WEBP
- 自动图片压缩与缩略图生成
- 文件大小限制: 单张5MB, 单记录最多10张

### 5.3 API设计
- RESTful API设计规范
- 统一的响应格式
- 适当的HTTP状态码使用
- API文档自动生成

### 5.4 前端架构
- React函数组件 + Hooks
- Material UI组件库
- 状态管理 (Context API 或 Redux)
- 路由管理 (React Router)

## 6. 开发计划

### 6.1 第一阶段 (核心功能)
- 用户认证系统
- 基础的记录CRUD功能
- 简单的检索功能

### 6.2 第二阶段 (完善功能)
- 参与者和场域管理
- 标签系统
- 图片上传功能

### 6.3 第三阶段 (高级功能)
- 统计分析功能
- 数据导出功能
- 系统优化与性能调优

## 7. 验收标准

### 7.1 功能验收
- 所有核心功能正常运行
- 用户权限控制正确
- 数据检索准确快速

### 7.2 性能验收
- 页面加载时间符合要求
- 大数据量下系统稳定运行
- 并发访问测试通过

### 7.3 安全验收
- 通过安全测试
- 数据隐私保护到位
- 系统漏洞扫描通过

---

**文档版本**: v1.0  
**创建日期**: 2024-12-01  
**最后更新**: 2024-12-01
